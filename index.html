<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="Towards Policy-Compliant Agents: Learning Efficient Guardrails For Policy Violation Detection">

  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="Policy Compliance, Autonomous Agents, Guardrail Models">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>PolicyGuard</title>
  <!-- Google Tag Manager -->
  <script>(function (w, d, s, l, i) {
    w[l] = w[l] || []; w[l].push({
      'gtm.start':
        new Date().getTime(), event: 'gtm.js'
    }); var f = d.getElementsByTagName(s)[0],
      j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
        'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
  })(window, document, 'script', 'dataLayer', 'GTM-MFCT45H');</script>
  <!-- End Google Tag Manager -->

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="stylesheet" href="./static/css/dataTables.bulma.css">
  <link rel="icon" href="./static/images/lvr_icon.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"
          onload="renderMathInElement(document.body);"></script>
  </head>
  <body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MFCT45H" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://rakanwen.github.io/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>

        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://arxiv.org/abs/2502.13458">
            ThinkGuard
          </a>
        </div>


      </div>
    </div>

  </div>
  </nav>



  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-2 publication-title"><img src="static/images/shield.png" width="100" /><font color="#96482c"> Towards Policy-Compliant Agents</font>: Learning Efficient Guardrails For Policy Violation Detection</h2>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
                <span class="author-block">
                  <a href="https://rakanwen.github.io/" target="_blank"><font color="#B082C9"><b>Xiaofei Wen</b></font></a><sup class="ucd-sup">&delta;</sup><a href="mailto:xfwe@ucdavis.edu" style="margin-left: 5px;"><i class="fas fa-envelope" style="color: #B082C9;"></i></a>&emsp;
                </span>

                <span class="author-block">
                 <a href="https://jacky-mo-1111.github.io/" target="_blank"><font color="#B082C9"><b>Wenjie Jacky Mo</b></font></a><sup class="ucd-sup">&delta;</sup>&emsp;
                </span>

                <span class="author-block">
                  <a href="https://alumni.soe.ucsc.edu/~lorabit/" target="_blank"><font color="#B082C9"><b>Yanan Xie</b></font></a><sup class="uniphore-sup">&mu;</sup>&emsp;
                 </span>
                 
                 <span class="author-block">
                  <a href="https://qipeng.me/" target="_blank"><font color="#B082C9"><b>Peng Qi</b></font></a><sup class="uniphore-sup">&mu;</sup>&emsp;
                 </span>
                 
                 <span class="author-block">
                  <a href="https://muhaochen.github.io/" target="_blank"><font color="#B082C9"><b>Muhao Chen</b></font></a><sup class="uniphore-sup">&delta;</sup>&emsp;
                 </span>
                 
                </div>
                <br>
                <div class="is-size-5 publication-authors">
                  <span class="author-block">
                    <sup class="ucd-sup">&delta;</sup><img src="static/images/ucd_logo.png" width="170" />&emsp;
                    <sup class="uniphore-sup">&mu;</sup><img src="static/images/Uniphore_idISh_h1Xo_0.svg" width="170" />&emsp;
                    <!-- <sup>*</sup>Equal Contribution&emsp;
                    <sup>â€ </sup>Equal Advising -->
                  </span>
                  <br>
                  <!-- <span class="author-block">
                    <h1 class="title is-4"><font color="#B03A2E"><b>ICML 2025</b></font></h1>
                  </span> -->
                </div>

                  <div class="content has-text-centered">
                    <div class="publication-links">
                      <span class="link-block">
                        <a href="https://arxiv.org/abs/2510.03485" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="ai ai-arxiv"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                    <!-- <span class="link-block">
                      <a href="https://github.com/VincentLeebang/lvr" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fab fa-github"></i>
                      </span>
                      <span>Code</span>
                    </a>
                    </span> -->
  
                    <span class="link-block">
                      <a href="https://huggingface.co/Rakancorle1/PolicyGuard-4B" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        ðŸ¤—
                      </span>
                      <span>Model</span>
                    </a>
                  </span>

                <span class="link-block">
                  <a href="https://huggingface.co/datasets/Rakancorle1/PolicyGuardBench" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fas fa-database"></i>
                  </span>
                  <span>Dataset</span>
                  </a>
                </span>

                <!-- <span class="link-block">
                  <a href="https://twitter.com/XingyuFu2/status/1781368539213082683" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fab fa-twitter"></i>
                  </span>
                  <span>Twitter</span>
                  </a>
                </span> -->
              </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Teaser image-->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <div class="notification is-info is-light" style="margin-top: 2rem; margin-bottom: 2rem;">
        <p class="subtitle has-text-centered">
          <h2 class="title is-3 has-text-centered">When â€˜safeâ€™ agents quietly break the rules, what trust can we truly place in their decisions?</h2>

        </p>
      </div>
      <h2 class="subtitle has-text-justified">
        <span style="font-weight:bold;">PolicyGuardBench</span> is a benchmark for evaluating whether autonomous agents comply with domain-specific and external policies over long trajectories. While agent safety has been widely studied, policy compliance remains largely overlooked, as agents in practice frequently complete tasks while violating rules such as overspending or bypassing constraints. To address this gap, <span style="font-weight:bold;">PolicyGuard-4B</span>  is introduced as a lightweight guardrail model that detects trajectory-level policy violations, making agent behavior more reliable.
      </h2>
      <img src="static/images/PolicyGuard_example.png" alt="Main figure for the project" style="width:100%; height:auto;"/>



      </div>
  </div>
</section>
<!-- End teaser image -->

<!-- Video comparison section -->
<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <h2 class="title is-3 has-text-centered">Human-Perceived Fake Traces</h2>
      <div class="columns is-centered">
        <div class="column is-half">
          <video autoplay muted loop controls style="width: 105%;">
            <source src="static/videos/sora.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <h3 class="subtitle has-text-centered">Original Video</h3>
        </div>
        <div class="column is-half">
          <video autoplay muted loop controls style="width: 95%;">
            <source src="static/videos/annotated_sora.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <h3 class="subtitle has-text-centered">Annotated Video</h3>
        </div>
      </div>
    </div>
  </div>
</section> -->
<!-- End video comparison section -->

<!-- Teaser video-->
<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video poster="" id="tree" autoplay controls muted loop style="width: 85%;">
        <source src="static/videos/LVR.mp4"
        type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        Brief illustrative video introduction about <span style="font-weight:bold;">LVR</span>.*
      </h2>
    </div>
  </div>
</section> -->
<!-- End teaser video -->


<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-sixths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Autonomous web agents need to operate under externally imposed or human-specified policies while generating long-horizon trajectories. However, little work has examined whether these trajectories comply with such policies, or whether policy violations persist across different contexts such as domains (e.g., shopping or coding websites) and subdomains (e.g., product search and order management in shopping). To address this gap, we introduce <span style="background-color: #f0f8ff; padding: 2px 4px; border-radius: 3px;"><strong>PolicyGuardBench</strong></span>, a benchmark of about 60k examples for detecting policy violations in agent trajectories. From diverse agent runs, we generate a broad set of policies and create both within subdomain and cross subdomain pairings with violation labels. In addition to full-trajectory evaluation, PolicyGuardBench also includes a prefix-based violation detection task where models must anticipate policy violations from truncated trajectory prefixes rather than complete sequences. Using this dataset, we train <span style="background-color: #f0f8ff; padding: 2px 4px; border-radius: 3px;"><strong>PolicyGuard-4B</strong></span>, a lightweight guardrail model that delivers strong detection accuracy across all tasks while keeping inference efficient. Notably, PolicyGuard-4B generalizes across domains and preserves high accuracy on unseen settings. Together, PolicyGuardBench and PolicyGuard-4B <span style="background-color: #e8f5e8; padding: 2px 4px; border-radius: 3px;"><strong> provide the first comprehensive framework for studying policy compliance in web agent trajectories</strong></span>, and show that accurate and generalizable guardrails are feasible at small scales. 
          </p>
          

        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->



<!-- Paper Qualitative -->
<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-sixths">
        <h2 class="title is-3">PolicyGuardBench Construction</h2>
        <img src="static/images/Data_Construct.png" width="100%"/>
        <!-- <img src="static/images/example2.png" width="100%"/> -->
        <!-- <h2 class="content has-text-centered"> -->
          <!-- <span style="font-size: 1.2em; font-weight: bold; color: #96482c;">
            The LVR model is purely autoregressive.
          </span> -->
        <div class="content has-text-justified" style="margin-top: 1em;">
          <p>
            <strong>PolicyGuardBench</strong> is constructed through a pipeline that begins by cleaning raw agent logs, removing noise, and canonicalizing actions into standardized trajectories. From these, over <strong>2,000 unique policies</strong> are synthesized via LLM prompting and human curation, covering obligations, prohibitions, ordering, and conditional rules. Trajectories are paired with policies using embedding retrieval and heuristics, producing nearly <strong>60,000 trajectoryâ€“policy pairs</strong> across <strong>five domains</strong>, of which about <strong>42% involve violations</strong> and <strong>42% require cross-subdomain transfer</strong>. Each pair is annotated for violation typesâ€”such as missing obligations, forbidden actions, or conditional breachesâ€”through a mix of human labels and LLM assistance. The benchmark further supports <strong>prefix-based splits</strong> (N=1â€“5 steps) to evaluate early violation detection.
          </p>
        </div>

        </h2>
        
      </div>
    </div>
  </div>
</section>


<!-- Paper Qualitative -->
<!-- <section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-sixths">
        <h2 class="title is-3"><span>GRPO<sub>latent</sub></span> for RL on latent reasoning models</h2>
        <img src="static/images/grpo_latent.png" width="80%"/>
        <h2 class="content has-text-justified">
          One key challenge in applying RL to latent reasoning models is that the token distribution over latent reasoning positions is not semantically meaningful. To address this, we propose <span>GRPO<sub>latent</sub></span>, which computes log probabilities only for textual tokens during the generation phase. Since text generation is conditioned on the LVR process, the latent reasoning steps are indirectly optimized through the policy gradient signal. The reward function combines an accuracy reward on VQA tasks with a format reward that encourages the activation of latent reasoning (<|lvr_start|>...<|lvr_end|>), making the latter serve not only as a response-format constraint but also as a mechanism to promote latent reasoning behavior.
        </h2>
      </div>
    </div>
  </div>
</section> -->


<!-- Paper Analysis -->
<!-- <section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <h2 class="title is-3"> <b>DeeptraceReward</b> Statistics </h2> <br>
    </div>
    <div class="columns is-centered">
      <div class="column is-five-sixths">
        <p>
          The dataset consists of <b>4,334 fake videos</b> generated by six state-of-the-art T2V models and <b>3,318 real videos</b> sourced from LLaVA-Video-178K (Zhang et al., 2024) for training. For both sources, we report: the number of videos, the proportion with human-written explanations, average resolution (mean height and width), average video length (seconds), and average length of annotated fake clues (based on start/end timestamps). The dataset features substantial diversity in both resolution and temporal duration across models.
        <br
        </p>  
        <br>
        <div class="columns is-centered has-text-centered">
        <img src="static/images/statistics.png" width="90%"/> </div>
      </div>
    </div>
  </div>
</section> -->

<!-- Paper Qualitative -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-sixths">
        <h2 class="title is-3">Benchmark Evaluation</h2>
        <img src="static/images/PG_exp.png" width="90%"/>
        <br>
        <h2 class="content has-text-justified">
          PolicyGuard-4B reaches <strong>90.1% accuracy</strong> and <strong>87.6% F1</strong>, while maintaining <strong>the lowest latency (22.5 ms per example)</strong> among all evaluated models. Compared to large foundation models such as Llama-3.3-70B-Instruct, which achieve similar scores at much higher inference cost, PolicyGuard-4B offers a far more efficient solution. Frontier models like Claude-Sonnet-4 and Gemini-1.5-Pro also perform strongly but remain closed-source and slower. In contrast, existing safety guardrailsâ€”including Llama Guard and ShieldGemmaâ€”show substantially lower effectiveness, with F1 often below 0.60.
        </h2>
        <br>
          <!-- <img src="static/images/category.png" width="90%"/> -->
      </div>
    </div>
  </div>
</section>

<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-sixths">
        <h2 class="title is-3">Prefix-Based Violation Detection</h2>
        <img src="static/images/prefix_trends_brown.png" width="95%"/>
        <br>
        <h2 class="content has-text-justified">
          Prefix-based evaluation tests whether models can anticipate policy violations from early trajectory steps. As shown above, most foundation and guardrail models suffer clear accuracy drops as prefix length increases, with smaller models (e.g., Llama-3.2-3B, Qwen3-4B) falling below 0.6 by N=5. Larger models like Llama-3.3-70B and Qwen3-235B remain stronger but still decline. In contrast, <strong>PolicyGuard-4B</strong> sustains accuracy above 0.85 across all prefixes, showing robustness to both short prefixes and longer trajectories.
        </h2>
        <br>
          <!-- <img src="static/images/category.png" width="90%"/> -->
      </div>
    </div>
  </div>
</section>


<!-- <section class="hero is-small">
  <div class="container is-max-desktop content">
    <br>
    <h2 class="title is-3">Related Work</h2>
    <ul>
      <li> <a href="https://visualsketchpad.github.io/">Visual Sketchpad: Sketching as a Visual Chain of Thought for Multimodal Language Models</a></li>
      <li> <a href="https://prior.allenai.org/projects/visprog">Visual Programming for Compositional Visual Reasoning</a></li>
      <li> <a href="https://viper.cs.columbia.edu/">ViperGPT: Visual Inference via Python Execution for Reasoning</a></li>
      <li> <a href="https://arxiv.org/abs/2210.03629">ReAct: Synergizing Reasoning and Acting in Language Models</a></li>
      <li> <a href="https://whiteboard.cs.columbia.edu/">Whiteboard-of-Thought: Thinking Step-by-Step Across Modalities</a></li>
      <li> <a href="https://arxiv.org/abs/2404.19205">TableVQA-Bench: A Visual Question Answering Benchmark on Multiple Table Domains</a> </li>
      <li> <a href="https://arxiv.org/abs/2203.10244">ChartQA: A Benchmark for Question Answering about Charts with Visual and Logical Reasoning</a> </li>
      <li> <a href="https://charxiv.github.io/">CharXiv: Charting Gaps in Realistic Chart Understanding in Multimodal LLMs</a> </li>
      <li> <a href="https://huggingface.co/microsoft/Phi-3.5-vision-instruct">Phi-3.5-vision Model</a> </li>
      <li> <a href="https://github.com/deepcs233/Visual-CoT">Visual CoT: Advancing Multi-Modal Language Models with a Comprehensive Dataset and Benchmark for Chain-of-Thought Reasoning</a> </li>
      <li> <a href="https://microsoft.github.io/visualization-of-thought/#/">Mind's Eye of LLMs: Visualization-of-Thought Elicits Spatial Reasoning in Large Language Models</a> </li>
    </ul>
  </div>
</section> -->

<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><bibtexcode>
        To Add Soon.
      </bibtexcode></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <!-- <p>
            *Video generated by SORA 2.
            
          </p> -->
          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from theÂ <a href="https://nerfies.github.io" target="_blank">Nerfies</a>Â project page.
            
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
  
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.2.1/js/bootstrap.bundle.min.js"></script>
    <script src="./static/js/jquery.csv.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.bulma.min.js"></script>
    <script src="./static/js/csv_to_html_table.js"></script>
    <script>
      CsvToHtmlTable.init({
        csv_path: 'static/val_result.csv', 
        element: 'table-container', 
        allow_download: true,
        csv_options: {separator: ',', delimiter: '"'},
        datatables_options: {
          "paging": false, 
          "order": [[1, 'desc']],
          "columnDefs": [
          {targets: [0], className: 'dt-left', className: 'dt-head-left'},
          ]
        }
      });
    </script>
  
  </body>
  </html>
